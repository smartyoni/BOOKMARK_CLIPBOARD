# ë³´ì•ˆ ë° ì„±ëŠ¥ ê°œì„ ì‚¬í•­

ì´ ë¬¸ì„œëŠ” ë¶ë§ˆí¬ í´ë¦½ë³´ë“œ ì•±ì˜ ë³´ì•ˆê³¼ ì½”ë“œ í’ˆì§ˆ ê°œì„ ì‚¬í•­ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

## ğŸ”’ ë³´ì•ˆ ê°œì„ ì‚¬í•­

### 1. Firebase ìê²©ì¦ëª… ê´€ë¦¬ (CRITICAL)

**ë¬¸ì œì :**
- Firebase API í‚¤ê°€ ì†ŒìŠ¤ì½”ë“œì— í•˜ë“œì½”ë”©ë˜ì–´ ìˆìŒ
- ëˆ„êµ¬ë‚˜ í”„ë¡œë•ì…˜ ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼ ê°€ëŠ¥ (Firebase ë³´ì•ˆ ê·œì¹™ì— ë”°ë¼)

**í•´ê²°ë°©ì•ˆ:**
- í™˜ê²½ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìê²©ì¦ëª… ê´€ë¦¬
- `.env` íŒŒì¼ ì‚¬ìš© (`.gitignore`ì— ì¶”ê°€)
- `window.FIREBASE_CONFIG` ê°ì²´ë¥¼ í†µí•´ ë™ì  ë¡œë“œ

**ì‚¬ìš© ë°©ë²•:**
```bash
# .env.exampleì„ ë³µì‚¬í•˜ì—¬ .env íŒŒì¼ ìƒì„±
cp .env.example .env

# .env íŒŒì¼ì— ì‹¤ì œ Firebase ìê²©ì¦ëª… ì…ë ¥
FIREBASE_API_KEY=your_actual_api_key
FIREBASE_AUTH_DOMAIN=your_auth_domain
# ... ê¸°íƒ€ ì„¤ì •
```

**í”„ë¡œë•ì…˜ ë°°í¬:**
- í˜¸ìŠ¤íŒ… í”Œë«í¼ì˜ í™˜ê²½ë³€ìˆ˜ ì„¤ì • ì‚¬ìš© (GitHub Pages Actions, Vercel, Netlify ë“±)
- ë¹Œë“œ ì‹œê°„ì— í™˜ê²½ë³€ìˆ˜ë¥¼ ì£¼ì…

### 2. XSS(Cross-Site Scripting) ì·¨ì•½ì  (HIGH)

**ë¬¸ì œì :**
- `innerHTML`ì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ë°ì´í„°ë¥¼ ì§ì ‘ ë Œë”ë§
- HTML/JavaScript ì¸ì ì…˜ ê³µê²© ê°€ëŠ¥ì„±

**ì˜í–¥ì„ ë°›ëŠ” ë¶€ë¶„:**
- í…œí”Œë¦¿ ì½˜í…ì¸  ë Œë”ë§ (ë¼ì¸ 2251, 2424, 2565)
- ë¶ë§ˆí¬/í´ë¦½ë³´ë“œ ì•„ì´í…œ ë Œë”ë§ (ë¼ì¸ 3672, 3847)
- ê²€ìƒ‰ ê²°ê³¼ ë Œë”ë§ (ë¼ì¸ 4693)

**ê¶Œì¥ì‚¬í•­:**
1. **ë‹¨ê¸°:** `textContent`ë¥¼ ì‚¬ìš©í•˜ì—¬ í…ìŠ¤íŠ¸ë§Œ ë Œë”ë§
2. **ì¥ê¸°:** DOMPurify ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€í•˜ì—¬ HTML ì‚°íƒ„í™”
3. **ì¦‰ì‹œ:** ëª¨ë“  ì‚¬ìš©ì ì…ë ¥ì— ëŒ€í•´ ìœ íš¨ì„± ê²€ì‚¬

**ì˜ˆì‹œ ê°œì„ :**
```javascript
// ì´ì „ (ìœ„í—˜)
contentEl.innerHTML = convertUrlsToLinks(item.text);

// ê°œì„  (ì•ˆì „)
contentEl.textContent = item.text;
// URLì€ ë”°ë¡œ ì²˜ë¦¬í•˜ê±°ë‚˜ ë§í¬ ë¯¸ë¦¬ë³´ê¸°ëŠ” ë³´ì•ˆ ê°€ëŠ¥í•œ ë°©ì‹ìœ¼ë¡œ
```

### 3. ì¸ì¦ ë° ê¶Œí•œ ê´€ë¦¬ (HIGH)

**ë¬¸ì œì :**
- ì‚¬ìš©ì ì¸ì¦ ë¯¸êµ¬í˜„
- ëˆ„êµ¬ë‚˜ ë°ì´í„°ì— ì ‘ê·¼ ê°€ëŠ¥ (Firebase ë³´ì•ˆ ê·œì¹™ì— ì „ì ìœ¼ë¡œ ì˜ì¡´)

**ê¶Œì¥ì‚¬í•­:**
```javascript
// Firebase ë³´ì•ˆ ê·œì¹™ (firestore.rules)
match /userdata/{userId}/{document=**} {
  allow read, write: if request.auth.uid == userId;
}

match /templates/{userId}/{document=**} {
  allow read: if true; // ê³µê°œ í…œí”Œë¦¿
  allow write: if request.auth.uid == userId;
}
```

### 4. ë°ì´í„° ì•”í˜¸í™” (MEDIUM)

**ë¬¸ì œì :**
- Firebaseì— í‰ë¬¸ ë°ì´í„° ì €ì¥
- í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ì•”í˜¸í™” ë¯¸êµ¬í˜„

**ê¶Œì¥ì‚¬í•­:**
- ë¯¼ê°í•œ ë°ì´í„°ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì•”í˜¸í™” í›„ ì „ì†¡
- TweetNaCl.js ë˜ëŠ” crypto-js ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©

## ğŸš€ ì„±ëŠ¥ ê°œì„ ì‚¬í•­

### 1. ê²€ìƒ‰ ì„±ëŠ¥ ìµœì í™”

**í˜„ì¬ ë°©ì‹:** ëª¨ë“  í‚¤ ì…ë ¥ ì‹œ DOM ì¬êµ¬ì„±
**ê°œì„  ë°©ì•ˆ:**
- ê²€ìƒ‰ ì¸ë±ìŠ¤ êµ¬í˜„ (lunr.js ë“±)
- ê²°ê³¼ í˜ì´ì§€ë„¤ì´ì…˜
- ê°€ìƒ ìŠ¤í¬ë¡¤ë§

### 2. ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ í•´ê²°

**ë¬¸ì œì :**
- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ì ì ˆíˆ ì •ë¦¬ë˜ì§€ ì•ŠìŒ
- ë™ì  DOM ìš”ì†Œ ìƒì„± í›„ ë¯¸ì •ë¦¬

**í•´ê²°:**
```javascript
// ì´ë²¤íŠ¸ ìœ„ì„ ì‚¬ìš©
document.addEventListener('click', (e) => {
  if (e.target.matches('.bookmark-item')) {
    handleBookmarkClick(e);
  }
});

// ëª¨ë‹¬ ë‹«ì„ ë•Œ ë¦¬ì†ŒìŠ¤ ì •ë¦¬
function closeModal() {
  modal.remove();
  // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì •ë¦¬
  modal.replaceWith(modal.cloneNode(true));
}
```

### 3. ë²ˆë“¤ í¬ê¸° ê°ì†Œ

**í˜„ì¬:** ë‹¨ì¼ HTML íŒŒì¼ (6,178ì¤„)
**ê¶Œì¥:**
- ëª¨ë“ˆ ë¶„ë¦¬ (ë³„ë„ì˜ JS íŒŒì¼ë¡œ êµ¬ì„±)
- ë²ˆë“¤ëŸ¬ ì‚¬ìš© (Webpack, Vite ë“±)
- CSS ìµœì†Œí™” ë° ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ ì œê±°

## ğŸ“‹ ì½”ë“œ í’ˆì§ˆ ê°œì„ 

### 1. ì½˜ì†” ë¡œê¹… ì •ë¦¬
- í”„ë¡œë•ì…˜ console.log/warn/error ì œê±°
- ì—ëŸ¬ ë¡œê¹…ì€ ì„œë¹„ìŠ¤ ì‚¬ìš© (Sentry ë“±)

### 2. ì…ë ¥ ê²€ì¦ ê°•í™”
```javascript
// ëª¨ë“  Firebase ì €ì¥ ì „ ê²€ì¦
function validateBookmarkData(data) {
  if (!data.text || typeof data.text !== 'string') {
    throw new Error('Invalid text field');
  }
  if (data.text.length > 10000) {
    throw new Error('Text exceeds maximum length');
  }
  // ... ê¸°íƒ€ ê²€ì¦
  return true;
}
```

### 3. ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ 
```javascript
// Firebase ì‘ì—… ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„ ë¡œì§
async function saveWithRetry(maxRetries = 3) {
  for (let i = 0; i < maxRetries; i++) {
    try {
      await saveToFirebase();
      return; // ì„±ê³µ
    } catch (error) {
      if (i === maxRetries - 1) {
        // ìµœì¢… ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼
        showErrorNotification('ë°ì´í„° ì €ì¥ ì‹¤íŒ¨. ë¡œì»¬ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
      }
      await wait(Math.pow(2, i) * 1000); // ì§€ìˆ˜ ë°±ì˜¤í”„
    }
  }
}
```

## ğŸ“š ê¶Œì¥ ì¶”ê°€ ê°œì„ ì‚¬í•­

### ìš°ì„ ìˆœìœ„: ë†’ìŒ
1. âœ… Firebase ìê²©ì¦ëª… í™˜ê²½ë³€ìˆ˜ ì´ë™
2. ì‚¬ìš©ì ì¸ì¦ êµ¬í˜„ (Firebase Auth)
3. Firebase ë³´ì•ˆ ê·œì¹™ ì„¤ì •
4. XSS ì·¨ì•½ì  ìˆ˜ì •

### ìš°ì„ ìˆœìœ„: ì¤‘ê°„
5. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì¶”ê°€ (Jest)
6. TypeScript ë„ì…
7. ëª¨ë“ˆ ë¶„ë¦¬ ë° ë²ˆë“¤ëŸ¬ ì„¤ì •
8. ì ‘ê·¼ì„± ê°œì„  (WCAG 2.1)

### ìš°ì„ ìˆœìœ„: ë‚®ìŒ
9. ê¸°ëŠ¥ ì¶”ê°€ (Undo/Redo, íƒœê·¸ ì‹œìŠ¤í…œ)
10. í˜‘ì—… í¸ì§‘ ì§€ì›
11. AI ìš”ì•½ ê¸°ëŠ¥ ê°œì„ 
12. ë‹¤êµ­ì–´ ì§€ì› í™•ëŒ€

## ğŸ”— ì°¸ê³  ìë£Œ

- [Firebase ë³´ì•ˆ ê·œì¹™ ë¬¸ì„œ](https://firebase.google.com/docs/firestore/security/start)
- [OWASP Top 10](https://owasp.org/Top10/)
- [ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸](https://cheatsheetseries.owasp.org/)
- [DOMPurify ë¼ì´ë¸ŒëŸ¬ë¦¬](https://github.com/cure53/DOMPurify)

## ğŸ“ ë³€ê²½ ì´ë ¥

### v2.1.0 (2024-10-21)
- âœ… Firebase ìê²©ì¦ëª… í™˜ê²½ë³€ìˆ˜ ê´€ë¦¬ ì‹œìŠ¤í…œ ì¶”ê°€
- âœ… .gitignore íŒŒì¼ ì¶”ê°€
- âœ… ë³´ì•ˆ ì£¼ì„ ì¶”ê°€
- âœ… ì½˜ì†” ë¡œê·¸ ì œê±° (ì¼ë¶€)
- ğŸ“ ì´ ë¬¸ì„œ ì¶”ê°€

## âš ï¸ ê¸´ê¸‰ ëŒ€ì‘ í•„ìš”

í˜„ì¬ ë…¸ì¶œëœ Firebase API í‚¤ëŠ”:
- **ì¦‰ì‹œ ì¬ìƒì„±í•˜ê±°ë‚˜ ë¬´íš¨í™”í•´ì•¼ í•©ë‹ˆë‹¤**
- Firebase ì½˜ì†”ì—ì„œ ìƒˆ API í‚¤ ìƒì„±
- ê¸°ì¡´ í‚¤ ì‚­ì œ
- ë³´ì•ˆ ê·œì¹™ ê²€í†  ë° ê°•í™”
